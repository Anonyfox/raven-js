<div class="product-grid">
	<h2>Featured Products ({{ products | size }})</h2>
	{% if user.isPremium %}
		<div class="premium-badge">Premium Member</div>
	{% endif %}

	<div class="products">
		{% for product in products %}
			<div class="product-card {% if product.featured %}featured{% endif %} {% unless product.inStock %}out-of-stock{% endunless %}">
				<div class="product-image">
					<img src="{{ product.imageUrl }}" alt="{{ product.name }}" />
					{% if product.discount > 0 %}
						<span class="discount-badge">-{{ product.discount }}%</span>
					{% endif %}
				</div>

				<div class="product-info">
					<h3 class="product-name">{{ product.name }}</h3>
					<p class="product-description">{{ product.description }}</p>

					<div class="product-categories">
						{% for category in product.categories %}
							<span class="category-tag">{{ category }}</span>
						{% endfor %}
					</div>

					<div class="product-price">
						{% if product.discount > 0 %}
							{% assign salePrice = product.price | times: product.discount | divided_by: 100 %}
							{% assign finalPrice = product.price | minus: salePrice %}
							<span class="original-price">${{ product.price | number }}</span>
							<span class="sale-price">${{ finalPrice | number }}</span>
						{% else %}
							<span class="current-price">${{ product.price | number }}</span>
						{% endif %}
					</div>

					<div class="product-stats">
						<div class="rating">
							{% for i in (1..5) %}
								{% assign ratingInt = product.rating | floor %}
								<span class="star {% if i <= ratingInt %}filled{% endif %}">â˜…</span>
							{% endfor %}
							<span class="rating-text">({{ product.reviews }})</span>
						</div>
					</div>

					<div class="product-actions">
						{% if product.inStock %}
							<button class="btn-primary" {% unless user.isLoggedIn %}disabled{% endunless %}>
								Add to Cart
							</button>
							{% if product.quantity < 5 %}
								<span class="low-stock">Only {{ product.quantity }} left!</span>
							{% endif %}
						{% else %}
							<button class="btn-secondary" disabled>Out of Stock</button>
						{% endif %}
					</div>

					{% if config.showAttributes %}
						<div class="product-attributes">
							{% for attribute in product.attributes %}
								<div class="attribute">
									<span class="attr-name">{{ attribute[0] }}:</span>
									<span class="attr-value">{{ attribute[1] }}</span>
								</div>
							{% endfor %}
						</div>
					{% endif %}
				</div>
			</div>
		{% endfor %}
	</div>
</div>
